
run_once(num_words=7000,dropout=0.5,num_hidden=512, extra_layers=0,plot=True,verbose=True,select_best=4000)



Using TensorFlow backend.
C:\Anaconda3\lib\site-packages\sklearn\cross_validation.py:44: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. Also note that the interface of the new CV iterators are different from that of this module. This module will be removed in 0.20.
  "This module will be removed in 0.20.", DeprecationWarning)
C:\Anaconda3\lib\site-packages\sklearn\grid_search.py:43: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. This module will be removed in 0.20.
  DeprecationWarning)
Creating email dataset with labels ['Bank', 'bvp_', 'Sent', 'Unread', 'corprova2011', 'deepak.gupta891@gmail.com', 'Inbox', 'Starred', 'deepak91g@live.com', 'Google', 'Imagic', 'MyUnplugged', 'Placement', 'Shruti', 'TCS'] 
Label word breakdown:
	Bank:4
	bvp_:7441
	Sent:1561
	Unread:6810
	corprova2011:10932
	deepak.gupta891@gmail.com:3880
	Inbox:4244
	Starred:60
	deepak91g@live.com:1093
	Google:347
	Imagic:3982
	MyUnplugged:34
	Placement:401
	Shruti:228
	TCS:1202
Total word count: 42219
Found 6 labels below count threshold of 7 
Creating email dataset with labels ['bvp_', 'corprova2011', 'deepak.gupta891@gmail.com', 'Inbox', 'deepak91g@live.com', 'Imagic', 'Placement', 'Shruti', 'TCS'] 
Label email count breakdown:
	bvp_:102
	corprova2011:238
	deepak.gupta891@gmail.com:73
	Inbox:47
	deepak91g@live.com:21
	Imagic:91
	Placement:8
	Shruti:17
	TCS:11
Total emails: 608
Wrote CSV with columns Index(['3d', 'the', 'com', 'to', 'font', 'and', 'of', 'a', 'style', 'in',
       ...
       'cheme', 'estimated', '3d8', 'punjabi', 'theheart', 'crowed',
       '001485f90d26d7a05c0496d28d1c', 'leavingheadstrong', 'substitutes',
       'label'],
      dtype='object', length=7001) to keras_data_7000_binary.csv

Selecting 4000 best features

548 train sequences
60 test sequences
X_train shape: (548, 4000)
X_test shape: (60, 4000)
Y_train shape: (548, 9)
Y_test shape: (60, 9)
Building model...
2017-06-20 21:56:56.061032: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:56:56.061847: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE2 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:56:56.062465: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:56:56.063080: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:56:56.063672: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:56:56.064238: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:56:56.064903: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:56:56.065604: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
Train on 493 samples, validate on 55 samples
Epoch 1/5

 32/493 [>.............................] - ETA: 2s - loss: 2.3258 - acc: 0.0625
 64/493 [==>...........................] - ETA: 1s - loss: 2.2255 - acc: 0.1562
 96/493 [====>.........................] - ETA: 1s - loss: 2.1076 - acc: 0.2812
128/493 [======>.......................] - ETA: 1s - loss: 2.0175 - acc: 0.3203
160/493 [========>.....................] - ETA: 1s - loss: 1.9451 - acc: 0.3563
192/493 [==========>...................] - ETA: 0s - loss: 1.8915 - acc: 0.3646
224/493 [============>.................] - ETA: 0s - loss: 1.8471 - acc: 0.3705
256/493 [==============>...............] - ETA: 0s - loss: 1.8120 - acc: 0.3867
288/493 [================>.............] - ETA: 0s - loss: 1.7640 - acc: 0.4132
320/493 [==================>...........] - ETA: 0s - loss: 1.7394 - acc: 0.4313
352/493 [====================>.........] - ETA: 0s - loss: 1.6613 - acc: 0.4744
384/493 [======================>.......] - ETA: 0s - loss: 1.6389 - acc: 0.4922
416/493 [========================>.....] - ETA: 0s - loss: 1.6245 - acc: 0.5024
448/493 [==========================>...] - ETA: 0s - loss: 1.5702 - acc: 0.5246
480/493 [============================>.] - ETA: 0s - loss: 1.5235 - acc: 0.5437
493/493 [==============================] - 1s - loss: 1.5174 - acc: 0.5477 - val_loss: 0.9599 - val_acc: 0.7273
Epoch 2/5

 32/493 [>.............................] - ETA: 1s - loss: 0.6342 - acc: 0.9062
 64/493 [==>...........................] - ETA: 1s - loss: 0.7257 - acc: 0.8594
 96/493 [====>.........................] - ETA: 1s - loss: 0.7257 - acc: 0.8750
128/493 [======>.......................] - ETA: 1s - loss: 0.7528 - acc: 0.8750
160/493 [========>.....................] - ETA: 0s - loss: 0.7005 - acc: 0.8875
192/493 [==========>...................] - ETA: 0s - loss: 0.6877 - acc: 0.8802
224/493 [============>.................] - ETA: 0s - loss: 0.6690 - acc: 0.8884
256/493 [==============>...............] - ETA: 0s - loss: 0.6837 - acc: 0.8711
288/493 [================>.............] - ETA: 0s - loss: 0.6672 - acc: 0.8715
320/493 [==================>...........] - ETA: 0s - loss: 0.6313 - acc: 0.8812
352/493 [====================>.........] - ETA: 0s - loss: 0.6301 - acc: 0.8778
384/493 [======================>.......] - ETA: 0s - loss: 0.6156 - acc: 0.8750
416/493 [========================>.....] - ETA: 0s - loss: 0.6093 - acc: 0.8774
448/493 [==========================>...] - ETA: 0s - loss: 0.6134 - acc: 0.8772
480/493 [============================>.] - ETA: 0s - loss: 0.6091 - acc: 0.8750
493/493 [==============================] - 1s - loss: 0.6053 - acc: 0.8783 - val_loss: 0.6439 - val_acc: 0.7636
Epoch 3/5

 32/493 [>.............................] - ETA: 1s - loss: 0.5171 - acc: 0.9375
 64/493 [==>...........................] - ETA: 1s - loss: 0.3939 - acc: 0.9375
 96/493 [====>.........................] - ETA: 1s - loss: 0.3413 - acc: 0.9583
128/493 [======>.......................] - ETA: 0s - loss: 0.3939 - acc: 0.9531
160/493 [========>.....................] - ETA: 0s - loss: 0.3488 - acc: 0.9625
192/493 [==========>...................] - ETA: 0s - loss: 0.3566 - acc: 0.9688
224/493 [============>.................] - ETA: 0s - loss: 0.3590 - acc: 0.9688
256/493 [==============>...............] - ETA: 0s - loss: 0.3434 - acc: 0.9688
288/493 [================>.............] - ETA: 0s - loss: 0.3317 - acc: 0.9688
320/493 [==================>...........] - ETA: 0s - loss: 0.3253 - acc: 0.9688
352/493 [====================>.........] - ETA: 0s - loss: 0.3209 - acc: 0.9688
384/493 [======================>.......] - ETA: 0s - loss: 0.3188 - acc: 0.9635
416/493 [========================>.....] - ETA: 0s - loss: 0.3220 - acc: 0.9567
448/493 [==========================>...] - ETA: 0s - loss: 0.3193 - acc: 0.9554
480/493 [============================>.] - ETA: 0s - loss: 0.3087 - acc: 0.9563
493/493 [==============================] - 1s - loss: 0.3079 - acc: 0.9574 - val_loss: 0.4898 - val_acc: 0.7818
Epoch 4/5

 32/493 [>.............................] - ETA: 1s - loss: 0.1790 - acc: 1.0000
 64/493 [==>...........................] - ETA: 1s - loss: 0.1394 - acc: 1.0000
 96/493 [====>.........................] - ETA: 1s - loss: 0.1902 - acc: 0.9792
128/493 [======>.......................] - ETA: 1s - loss: 0.1911 - acc: 0.9844
160/493 [========>.....................] - ETA: 0s - loss: 0.1972 - acc: 0.9750
192/493 [==========>...................] - ETA: 0s - loss: 0.2029 - acc: 0.9792
224/493 [============>.................] - ETA: 0s - loss: 0.1997 - acc: 0.9821
256/493 [==============>...............] - ETA: 0s - loss: 0.1938 - acc: 0.9805
288/493 [================>.............] - ETA: 0s - loss: 0.1822 - acc: 0.9792
320/493 [==================>...........] - ETA: 0s - loss: 0.1853 - acc: 0.9750
352/493 [====================>.........] - ETA: 0s - loss: 0.1740 - acc: 0.9773
384/493 [======================>.......] - ETA: 0s - loss: 0.1690 - acc: 0.9792
416/493 [========================>.....] - ETA: 0s - loss: 0.1679 - acc: 0.9808
448/493 [==========================>...] - ETA: 0s - loss: 0.1608 - acc: 0.9821
480/493 [============================>.] - ETA: 0s - loss: 0.1645 - acc: 0.9812
493/493 [==============================] - 1s - loss: 0.1641 - acc: 0.9817 - val_loss: 0.4370 - val_acc: 0.8182
Epoch 5/5

 32/493 [>.............................] - ETA: 1s - loss: 0.2091 - acc: 0.9375
 64/493 [==>...........................] - ETA: 1s - loss: 0.1487 - acc: 0.9688
 96/493 [====>.........................] - ETA: 1s - loss: 0.1339 - acc: 0.9792
128/493 [======>.......................] - ETA: 1s - loss: 0.1307 - acc: 0.9844
160/493 [========>.....................] - ETA: 0s - loss: 0.1331 - acc: 0.9812
192/493 [==========>...................] - ETA: 0s - loss: 0.1343 - acc: 0.9792
224/493 [============>.................] - ETA: 0s - loss: 0.1366 - acc: 0.9821
256/493 [==============>...............] - ETA: 0s - loss: 0.1292 - acc: 0.9844
288/493 [================>.............] - ETA: 0s - loss: 0.1274 - acc: 0.9861
320/493 [==================>...........] - ETA: 0s - loss: 0.1245 - acc: 0.9844
352/493 [====================>.........] - ETA: 0s - loss: 0.1263 - acc: 0.9830
384/493 [======================>.......] - ETA: 0s - loss: 0.1238 - acc: 0.9844
416/493 [========================>.....] - ETA: 0s - loss: 0.1200 - acc: 0.9832
448/493 [==========================>...] - ETA: 0s - loss: 0.1141 - acc: 0.9844
480/493 [============================>.] - ETA: 0s - loss: 0.1132 - acc: 0.9854
493/493 [==============================] - 1s - loss: 0.1110 - acc: 0.9858 - val_loss: 0.3991 - val_acc: 0.8182

32/60 [===============>..............] - ETA: 0s
60/60 [==============================] - 0s     
Test score: 0.259402511517
Test accuracy: 0.916666654746

60/60 [==============================] - 0s

Confusion matrix:
[[15  1  0  0  0  0  0  0]
 [ 0 26  0  0  0  0  0  0]
 [ 0  2  3  0  0  0  0  0]
 [ 0  0  0  2  0  0  0  0]
 [ 0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  6  0  0]
 [ 0  0  1  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  2]]
[Finished in 26.9s]