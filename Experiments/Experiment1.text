Using TensorFlow backend.
C:\Anaconda3\lib\site-packages\sklearn\cross_validation.py:44: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. Also note that the interface of the new CV iterators are different from that of this module. This module will be removed in 0.20.
  "This module will be removed in 0.20.", DeprecationWarning)
C:\Anaconda3\lib\site-packages\sklearn\grid_search.py:43: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. This module will be removed in 0.20.
  DeprecationWarning)
Parsing Bank.mbox
Parsed 1 emails

Parsing bvp_.mbox
Parsed 111 emails

Parsing corprova2011.mbox
Parsed 238 emails

Parsing deepak.gupta891@gmail.com.mbox
Parsed 202 emails

Parsing deepak91g@live.com.mbox
Parsed 26 emails

Parsing Google.mbox
Parsed 2 emails

Parsing Imagic.mbox
Parsed 162 emails

Parsing moviepsycho.mbox
Parsed 3 emails

Parsing MyUnplugged.mbox
Parsed 2 emails

Parsing Placement.mbox
Parsed 9 emails

Parsing Shruti.mbox
Parsed 19 emails

Parsing TCS.mbox
Parsed 12 emails

Creating email dataset with labels ['Bank', 'bvp_', 'Sent', 'Unread', 'corprova2011', 'deepak.gupta891@gmail.com', 'Inbox', 'Starred', 'deepak91g@live.com', 'Google', 'Imagic', 'MyUnplugged', 'Placement', 'Shruti', 'TCS'] 
Label word breakdown:
	Bank:4
	bvp_:7441
	Sent:1561
	Unread:6810
	corprova2011:10932
	deepak.gupta891@gmail.com:3880
	Inbox:4244
	Starred:60
	deepak91g@live.com:1093
	Google:347
	Imagic:3982
	MyUnplugged:34
	Placement:401
	Shruti:228
	TCS:1202
Total word count: 42219
Found 6 labels below count threshold of 7 
Creating email dataset with labels ['bvp_', 'corprova2011', 'deepak.gupta891@gmail.com', 'Inbox', 'deepak91g@live.com', 'Imagic', 'Placement', 'Shruti', 'TCS'] 
Label email count breakdown:
	bvp_:102
	corprova2011:238
	deepak.gupta891@gmail.com:73
	Inbox:47
	deepak91g@live.com:21
	Imagic:91
	Placement:8
	Shruti:17
	TCS:11
Total emails: 608
Wrote CSV with columns Index(['3d', 'the', 'com', 'to', 'font', 'and', 'of', 'a', 'style', 'in',
       ...
       'etec', 'vqlulxqu3', 'brilliant', 'yahoocomnagarro', 'e2e2e2', 'eating',
       'qoc', 'customizat', 'htmlsent', 'label'],
      dtype='object', length=11001) to keras_data_11000_binary.csv

Selecting 4000 best features

548 train sequences
60 test sequences
X_train shape: (548, 4000)
X_test shape: (60, 4000)
Y_train shape: (548, 9)
Y_test shape: (60, 9)
Building model...
2017-06-20 21:39:31.511657: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:39:31.522471: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE2 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:39:31.524106: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:39:31.525655: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:39:31.527066: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:39:31.528478: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:39:31.530601: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:39:31.531796: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
Train on 493 samples, validate on 55 samples
Epoch 1/5

 32/493 [>.............................] - ETA: 11s - loss: 2.1728 - acc: 0.2812
 64/493 [==>...........................] - ETA: 5s - loss: 2.1758 - acc: 0.2031 
 96/493 [====>.........................] - ETA: 4s - loss: 2.1076 - acc: 0.2708
128/493 [======>.......................] - ETA: 3s - loss: 2.0611 - acc: 0.3047
160/493 [========>.....................] - ETA: 2s - loss: 2.0115 - acc: 0.3250
192/493 [==========>...................] - ETA: 2s - loss: 1.9795 - acc: 0.3438
224/493 [============>.................] - ETA: 1s - loss: 1.9591 - acc: 0.3482
256/493 [==============>...............] - ETA: 1s - loss: 1.9168 - acc: 0.3828
288/493 [================>.............] - ETA: 1s - loss: 1.8939 - acc: 0.3785
320/493 [==================>...........] - ETA: 0s - loss: 1.8818 - acc: 0.3750
352/493 [====================>.........] - ETA: 0s - loss: 1.8455 - acc: 0.3778
384/493 [======================>.......] - ETA: 0s - loss: 1.8195 - acc: 0.3854
416/493 [========================>.....] - ETA: 0s - loss: 1.7706 - acc: 0.4111
448/493 [==========================>...] - ETA: 0s - loss: 1.7241 - acc: 0.4308
480/493 [============================>.] - ETA: 0s - loss: 1.6925 - acc: 0.4479
493/493 [==============================] - 2s - loss: 1.6778 - acc: 0.4564 - val_loss: 0.9683 - val_acc: 0.7818
Epoch 2/5

 32/493 [>.............................] - ETA: 1s - loss: 0.9769 - acc: 0.8125
 64/493 [==>...........................] - ETA: 1s - loss: 1.0095 - acc: 0.7344
 96/493 [====>.........................] - ETA: 1s - loss: 1.0127 - acc: 0.7292
128/493 [======>.......................] - ETA: 1s - loss: 1.0168 - acc: 0.7266
160/493 [========>.....................] - ETA: 1s - loss: 1.0499 - acc: 0.7063
192/493 [==========>...................] - ETA: 0s - loss: 1.0690 - acc: 0.7031
224/493 [============>.................] - ETA: 0s - loss: 1.0764 - acc: 0.7054
256/493 [==============>...............] - ETA: 0s - loss: 1.0590 - acc: 0.7109
288/493 [================>.............] - ETA: 0s - loss: 0.9953 - acc: 0.7396
320/493 [==================>...........] - ETA: 0s - loss: 0.9897 - acc: 0.7406
352/493 [====================>.........] - ETA: 0s - loss: 0.9583 - acc: 0.7500
384/493 [======================>.......] - ETA: 0s - loss: 0.9346 - acc: 0.7552
416/493 [========================>.....] - ETA: 0s - loss: 0.9019 - acc: 0.7716
448/493 [==========================>...] - ETA: 0s - loss: 0.8712 - acc: 0.7835
480/493 [============================>.] - ETA: 0s - loss: 0.8689 - acc: 0.7854
493/493 [==============================] - 1s - loss: 0.8640 - acc: 0.7850 - val_loss: 0.5612 - val_acc: 0.7636
Epoch 3/5

 32/493 [>.............................] - ETA: 1s - loss: 0.6615 - acc: 0.8125
 64/493 [==>...........................] - ETA: 1s - loss: 0.4449 - acc: 0.8906
 96/493 [====>.........................] - ETA: 1s - loss: 0.5027 - acc: 0.8542
128/493 [======>.......................] - ETA: 1s - loss: 0.4729 - acc: 0.8672
160/493 [========>.....................] - ETA: 1s - loss: 0.4641 - acc: 0.8688
192/493 [==========>...................] - ETA: 1s - loss: 0.4487 - acc: 0.8750
224/493 [============>.................] - ETA: 0s - loss: 0.4512 - acc: 0.8661
256/493 [==============>...............] - ETA: 0s - loss: 0.4663 - acc: 0.8594
288/493 [================>.............] - ETA: 0s - loss: 0.4680 - acc: 0.8646
320/493 [==================>...........] - ETA: 0s - loss: 0.4681 - acc: 0.8688
352/493 [====================>.........] - ETA: 0s - loss: 0.4363 - acc: 0.8807
384/493 [======================>.......] - ETA: 0s - loss: 0.4122 - acc: 0.8906
416/493 [========================>.....] - ETA: 0s - loss: 0.4101 - acc: 0.8942
448/493 [==========================>...] - ETA: 0s - loss: 0.3936 - acc: 0.9018
480/493 [============================>.] - ETA: 0s - loss: 0.3876 - acc: 0.9042
493/493 [==============================] - 1s - loss: 0.3839 - acc: 0.9047 - val_loss: 0.3111 - val_acc: 0.8909
Epoch 4/5

 32/493 [>.............................] - ETA: 1s - loss: 0.2903 - acc: 0.9375
 64/493 [==>...........................] - ETA: 1s - loss: 0.1829 - acc: 0.9688
 96/493 [====>.........................] - ETA: 1s - loss: 0.1705 - acc: 0.9792
128/493 [======>.......................] - ETA: 1s - loss: 0.2065 - acc: 0.9688
160/493 [========>.....................] - ETA: 1s - loss: 0.2087 - acc: 0.9688
192/493 [==========>...................] - ETA: 0s - loss: 0.1897 - acc: 0.9740
224/493 [============>.................] - ETA: 0s - loss: 0.1900 - acc: 0.9688
256/493 [==============>...............] - ETA: 0s - loss: 0.1786 - acc: 0.9727
288/493 [================>.............] - ETA: 0s - loss: 0.1905 - acc: 0.9653
320/493 [==================>...........] - ETA: 0s - loss: 0.1858 - acc: 0.9594
352/493 [====================>.........] - ETA: 0s - loss: 0.1989 - acc: 0.9517
384/493 [======================>.......] - ETA: 0s - loss: 0.1935 - acc: 0.9531
416/493 [========================>.....] - ETA: 0s - loss: 0.1883 - acc: 0.9519
448/493 [==========================>...] - ETA: 0s - loss: 0.1878 - acc: 0.9531
480/493 [============================>.] - ETA: 0s - loss: 0.1844 - acc: 0.9542
493/493 [==============================] - 1s - loss: 0.1846 - acc: 0.9533 - val_loss: 0.2796 - val_acc: 0.9091
Epoch 5/5

 32/493 [>.............................] - ETA: 1s - loss: 0.0359 - acc: 1.0000
 64/493 [==>...........................] - ETA: 1s - loss: 0.0674 - acc: 1.0000
 96/493 [====>.........................] - ETA: 1s - loss: 0.1467 - acc: 0.9792
128/493 [======>.......................] - ETA: 1s - loss: 0.1340 - acc: 0.9766
160/493 [========>.....................] - ETA: 1s - loss: 0.1360 - acc: 0.9750
192/493 [==========>...................] - ETA: 0s - loss: 0.1223 - acc: 0.9792
224/493 [============>.................] - ETA: 0s - loss: 0.1152 - acc: 0.9821
256/493 [==============>...............] - ETA: 0s - loss: 0.1197 - acc: 0.9844
288/493 [================>.............] - ETA: 0s - loss: 0.1298 - acc: 0.9826
320/493 [==================>...........] - ETA: 0s - loss: 0.1309 - acc: 0.9812
352/493 [====================>.........] - ETA: 0s - loss: 0.1281 - acc: 0.9773
384/493 [======================>.......] - ETA: 0s - loss: 0.1232 - acc: 0.9766
416/493 [========================>.....] - ETA: 0s - loss: 0.1225 - acc: 0.9760
448/493 [==========================>...] - ETA: 0s - loss: 0.1202 - acc: 0.9754
480/493 [============================>.] - ETA: 0s - loss: 0.1183 - acc: 0.9771
493/493 [==============================] - 1s - loss: 0.1165 - acc: 0.9777 - val_loss: 0.3322 - val_acc: 0.9091

32/60 [===============>..............] - ETA: 0s
60/60 [==============================] - 0s     
Test score: 0.512803765138
Test accuracy: 0.86666667064

60/60 [==============================] - 0s

Confusion matrix:
[[ 4  1  0  0  0  0  0]
 [ 0 22  0  0  0  0  0]
 [ 1  0 11  2  0  0  0]
 [ 0  0  0  5  0  2  0]
 [ 0  0  1  0  1  0  0]
 [ 0  0  0  1  0  6  0]
 [ 0  0  0  0  0  0  3]]
[Finished in 111.2s]