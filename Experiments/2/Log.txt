run_once(num_words=5000,dropout=0.5,num_hidden=512, extra_layers=0,plot=True,verbose=True,select_best=4000)



Using TensorFlow backend.
C:\Anaconda3\lib\site-packages\sklearn\cross_validation.py:44: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. Also note that the interface of the new CV iterators are different from that of this module. This module will be removed in 0.20.
  "This module will be removed in 0.20.", DeprecationWarning)
C:\Anaconda3\lib\site-packages\sklearn\grid_search.py:43: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. This module will be removed in 0.20.
  DeprecationWarning)
Read CSV with columns Index(['Unnamed: 0', '3d', 'the', 'com', 'to', 'font', 'and', 'of', 'a',
       'style',
       ...
       'labs', 'posten', 'deepak91gpassword', '3d10335', 'additionaladspace',
       'a0prepare', 'dhanwan', 'forever', '8875thanks', 'label'],
      dtype='object', length=5002)

Selecting 4000 best features

548 train sequences
60 test sequences
X_train shape: (548, 4000)
X_test shape: (60, 4000)
Y_train shape: (548, 9)
Y_test shape: (60, 9)
Building model...
2017-06-20 21:55:30.625385: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:55:30.626206: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE2 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:55:30.627351: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:55:30.628335: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:55:30.629152: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:55:30.629892: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:55:30.630440: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-06-20 21:55:30.631191: W c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
Train on 493 samples, validate on 55 samples
Epoch 1/5

 32/493 [>.............................] - ETA: 2s - loss: 2.2285 - acc: 0.0312
 64/493 [==>...........................] - ETA: 1s - loss: 2.1789 - acc: 0.1250
 96/493 [====>.........................] - ETA: 1s - loss: 2.1361 - acc: 0.2292
128/493 [======>.......................] - ETA: 1s - loss: 2.0511 - acc: 0.2891
160/493 [========>.....................] - ETA: 1s - loss: 1.9794 - acc: 0.3500
192/493 [==========>...................] - ETA: 1s - loss: 1.9011 - acc: 0.3906
224/493 [============>.................] - ETA: 0s - loss: 1.8977 - acc: 0.4196
256/493 [==============>...............] - ETA: 0s - loss: 1.8491 - acc: 0.4375
288/493 [================>.............] - ETA: 0s - loss: 1.7883 - acc: 0.4688
320/493 [==================>...........] - ETA: 0s - loss: 1.7343 - acc: 0.4906
352/493 [====================>.........] - ETA: 0s - loss: 1.6918 - acc: 0.5085
384/493 [======================>.......] - ETA: 0s - loss: 1.6473 - acc: 0.5286
416/493 [========================>.....] - ETA: 0s - loss: 1.5905 - acc: 0.5433
448/493 [==========================>...] - ETA: 0s - loss: 1.5537 - acc: 0.5558
480/493 [============================>.] - ETA: 0s - loss: 1.5336 - acc: 0.5583
493/493 [==============================] - 1s - loss: 1.5185 - acc: 0.5659 - val_loss: 0.8948 - val_acc: 0.7636
Epoch 2/5

 32/493 [>.............................] - ETA: 1s - loss: 0.8302 - acc: 0.8125
 64/493 [==>...........................] - ETA: 1s - loss: 0.7211 - acc: 0.8750
 96/493 [====>.........................] - ETA: 1s - loss: 0.6786 - acc: 0.9062
128/493 [======>.......................] - ETA: 1s - loss: 0.7047 - acc: 0.8984
160/493 [========>.....................] - ETA: 0s - loss: 0.6903 - acc: 0.8938
192/493 [==========>...................] - ETA: 0s - loss: 0.7127 - acc: 0.8750
224/493 [============>.................] - ETA: 0s - loss: 0.6853 - acc: 0.8884
256/493 [==============>...............] - ETA: 0s - loss: 0.6562 - acc: 0.8945
288/493 [================>.............] - ETA: 0s - loss: 0.6454 - acc: 0.9062
320/493 [==================>...........] - ETA: 0s - loss: 0.6337 - acc: 0.9094
352/493 [====================>.........] - ETA: 0s - loss: 0.6293 - acc: 0.9091
384/493 [======================>.......] - ETA: 0s - loss: 0.6110 - acc: 0.9115
416/493 [========================>.....] - ETA: 0s - loss: 0.6146 - acc: 0.9062
448/493 [==========================>...] - ETA: 0s - loss: 0.6054 - acc: 0.9062
480/493 [============================>.] - ETA: 0s - loss: 0.5949 - acc: 0.9083
493/493 [==============================] - 1s - loss: 0.5906 - acc: 0.9087 - val_loss: 0.6170 - val_acc: 0.8182
Epoch 3/5

 32/493 [>.............................] - ETA: 1s - loss: 0.3356 - acc: 0.9688
 64/493 [==>...........................] - ETA: 1s - loss: 0.4092 - acc: 0.9531
 96/493 [====>.........................] - ETA: 1s - loss: 0.4259 - acc: 0.9479
128/493 [======>.......................] - ETA: 0s - loss: 0.3912 - acc: 0.9609
160/493 [========>.....................] - ETA: 0s - loss: 0.3758 - acc: 0.9500
192/493 [==========>...................] - ETA: 0s - loss: 0.3559 - acc: 0.9531
224/493 [============>.................] - ETA: 0s - loss: 0.3369 - acc: 0.9598
256/493 [==============>...............] - ETA: 0s - loss: 0.3214 - acc: 0.9609
288/493 [================>.............] - ETA: 0s - loss: 0.3168 - acc: 0.9583
320/493 [==================>...........] - ETA: 0s - loss: 0.3029 - acc: 0.9594
352/493 [====================>.........] - ETA: 0s - loss: 0.2900 - acc: 0.9602
384/493 [======================>.......] - ETA: 0s - loss: 0.2811 - acc: 0.9635
416/493 [========================>.....] - ETA: 0s - loss: 0.2978 - acc: 0.9567
448/493 [==========================>...] - ETA: 0s - loss: 0.2893 - acc: 0.9598
480/493 [============================>.] - ETA: 0s - loss: 0.2907 - acc: 0.9563
493/493 [==============================] - 1s - loss: 0.2865 - acc: 0.9574 - val_loss: 0.5537 - val_acc: 0.8364
Epoch 4/5

 32/493 [>.............................] - ETA: 1s - loss: 0.1906 - acc: 0.9688
 64/493 [==>...........................] - ETA: 1s - loss: 0.2345 - acc: 0.9688
 96/493 [====>.........................] - ETA: 1s - loss: 0.2502 - acc: 0.9688
128/493 [======>.......................] - ETA: 1s - loss: 0.2132 - acc: 0.9766
160/493 [========>.....................] - ETA: 0s - loss: 0.1882 - acc: 0.9812
192/493 [==========>...................] - ETA: 0s - loss: 0.1822 - acc: 0.9844
224/493 [============>.................] - ETA: 0s - loss: 0.1738 - acc: 0.9866
256/493 [==============>...............] - ETA: 0s - loss: 0.1860 - acc: 0.9844
288/493 [================>.............] - ETA: 0s - loss: 0.1760 - acc: 0.9861
320/493 [==================>...........] - ETA: 0s - loss: 0.1826 - acc: 0.9844
352/493 [====================>.........] - ETA: 0s - loss: 0.1764 - acc: 0.9858
384/493 [======================>.......] - ETA: 0s - loss: 0.1684 - acc: 0.9870
416/493 [========================>.....] - ETA: 0s - loss: 0.1677 - acc: 0.9856
448/493 [==========================>...] - ETA: 0s - loss: 0.1701 - acc: 0.9821
480/493 [============================>.] - ETA: 0s - loss: 0.1642 - acc: 0.9833
493/493 [==============================] - 1s - loss: 0.1625 - acc: 0.9838 - val_loss: 0.5059 - val_acc: 0.8364
Epoch 5/5

 32/493 [>.............................] - ETA: 1s - loss: 0.1547 - acc: 1.0000
 64/493 [==>...........................] - ETA: 1s - loss: 0.1750 - acc: 0.9688
 96/493 [====>.........................] - ETA: 1s - loss: 0.1470 - acc: 0.9792
128/493 [======>.......................] - ETA: 1s - loss: 0.1438 - acc: 0.9844
160/493 [========>.....................] - ETA: 0s - loss: 0.1386 - acc: 0.9875
192/493 [==========>...................] - ETA: 0s - loss: 0.1254 - acc: 0.9896
224/493 [============>.................] - ETA: 0s - loss: 0.1203 - acc: 0.9911
256/493 [==============>...............] - ETA: 0s - loss: 0.1124 - acc: 0.9922
288/493 [================>.............] - ETA: 0s - loss: 0.1137 - acc: 0.9931
320/493 [==================>...........] - ETA: 0s - loss: 0.1114 - acc: 0.9906
352/493 [====================>.........] - ETA: 0s - loss: 0.1196 - acc: 0.9830
384/493 [======================>.......] - ETA: 0s - loss: 0.1155 - acc: 0.9844
416/493 [========================>.....] - ETA: 0s - loss: 0.1143 - acc: 0.9832
448/493 [==========================>...] - ETA: 0s - loss: 0.1101 - acc: 0.9844
480/493 [============================>.] - ETA: 0s - loss: 0.1050 - acc: 0.9854
493/493 [==============================] - 1s - loss: 0.1038 - acc: 0.9858 - val_loss: 0.5095 - val_acc: 0.8909

32/60 [===============>..............] - ETA: 0s
60/60 [==============================] - 0s     
Test score: 0.300797760487
Test accuracy: 0.88333332936

60/60 [==============================] - 0s

Confusion matrix:
[[ 9  0  0  0  0  0  0  0]
 [ 0 24  0  0  0  0  0  0]
 [ 0  1  8  1  0  0  0  0]
 [ 0  0  0  2  0  1  0  0]
 [ 0  0  0  0  2  0  0  0]
 [ 0  0  0  2  0  7  0  0]
 [ 0  2  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1]]
[Finished in 17.2s]